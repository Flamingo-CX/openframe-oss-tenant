port: 4222

http: 8222

websocket {
  port: 8080
  no_tls: true
}

# JetStream Configuration
jetstream {
  store_dir: "/data/jetstream"
}

accounts: {
  SYS: {
    users: [
      { user: "admin", password: "secret" }
    ],
    exports: [
      # SYS экспортирует device.*.commands в DEVICES
      { stream: "device.*.commands", accounts: ["DEVICES"] }
    ]
  },
  DEVICES: {
    users: [
      {
        user: "device",
        password: "1234",  # Пустой нельзя — задаём простой пароль
        permissions: {
          subscribe: { allow: ["device.*.commands", "events.>", "_INBOX.>", "$JS.ACK.>", "$JS.HB.>" ] },
          publish:   { allow: [] }  # device ничего не публикует
        }
      }
    ],
    imports: [
      # Импортируем стрим device.*.commands из SYS
      { stream: { account: "SYS", subject: "device.*.commands" } }
    ],
    # JetStream включен для аккаунта DEVICES
    jetstream: enabled
  }
}

system_account: SYS