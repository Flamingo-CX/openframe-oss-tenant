apiVersion: skaffold/v4beta13
kind: Config
metadata:
  name: external-api
build:
  tagPolicy:
    customTemplate:
      template:  "latest"
  artifacts:
    - image: ghcr.io/flamingo-cx/openframe/external-api
      context: .
      sync: 
        manual:
          - src: "**/*"
            dest: "/app"
      docker:
        dockerfile: Dockerfile
      hooks:
        before:
          - command: [ "mvn", "clean", "package", "-DskipTests"]
      docker: {}
  local:
    useDockerCLI: false
    useBuildkit: true
    push: true
manifests:
  kustomize:
    paths:
    - ../../../manifests/microservices/external-api
