<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
    <title>OpenFrame</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <script type="module" src="/src/main.ts"></script>
  </head>
  <body>
    <div id="app"></div>
    <script>
      (function() {
        // Create a secure config object
        const config = {
          apiUrl: import.meta.env.VITE_API_URL,
          gatewayUrl: import.meta.env.VITE_GATEWAY_URL,
          clientId: import.meta.env.VITE_CLIENT_ID,
          clientSecret: import.meta.env.VITE_CLIENT_SECRET,
          grafanaUrl: import.meta.env.VITE_GRAFANA_URL
        };

        // Create a secure getter function
        const getConfig = (key) => {
          if (key === 'clientSecret') return undefined;
          return config[key];
        };

        // Make the config non-enumerable and non-configurable
        Object.defineProperty(window, '__RUNTIME_CONFIG__', {
          value: getConfig,
          writable: false,
          configurable: false,
          enumerable: false
        });

        // Hide the config from console.log
        const originalConsoleLog = console.log;
        console.log = function(...args) {
          if (args.some(arg => arg === window.__RUNTIME_CONFIG__ || arg === config)) {
            return;
          }
          originalConsoleLog.apply(console, args);
        };

        // Prevent access to the config object
        Object.freeze(config);
      })();
    </script>
  </body>
</html>
