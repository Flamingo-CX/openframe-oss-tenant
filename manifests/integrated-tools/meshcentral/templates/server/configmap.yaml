apiVersion: v1
kind: ConfigMap
metadata:
  name: meshcentral-server
data:
  MONGO_INITDB_DATABASE: "meshcentral"
  MESH_DEVICE_GROUP: "OpenFrame"
  MESH_PORT: "8383"
  MESH_HOST: "0.0.0.0"
  MESH_EXTERNAL_HOST: "meshcentral-server.integrated-tools.svc.cluster.local"
  MESH_EXTERNAL_PORT: "8383"
  MESH_PERSISTENT_CONFIG: "0"
  MESH_DISABLE_SSL: "1"
  MESH_COMPRESSION_ENABLED: "true"
  MESH_WEBRTC_ENABLED: "false"
  MESH_TEMP_DIR: "/tmp/mesh"
  MESH_DIR: "/opt/mesh"
  {{- if eq .Values.deployment.ingress "ngrok" }}
  MESH_PROTOCOL: "wss"
  {{- else if eq .Values.deployment.ingress "localhost" }}
  MESH_PROTOCOL: "ws"
  {{- end }}

  MESH_NGINX_NAT_HOST: "meshcentral-server.integrated-tools.svc.cluster.local"
  MESH_NGINX_HOST: "meshcentral-server.integrated-tools.svc.cluster.local"
  MESH_NGINX_PORT: "80"
  {{- if eq .Values.deployment.ingress "ngrok" }}
  MESH_NGINX_PROTOCOL: "https"
  {{- else if eq .Values.deployment.ingress "localhost" }}
  MESH_NGINX_PROTOCOL: "http"
  {{- end }}
