apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: platform-helm-apps
spec:
  generators:
  - list:  # appName == namespace == chart
      elements: 

      - appName: cert-manager
        repoURL: https://charts.jetstack.io
        targetRevision: 1.17.2
        path: deploy/dev/platform/base/cert-manager
        branch: main
        syncWave: "-1"   

      - appName: ingress-nginx
        repoURL: https://kubernetes.github.io/ingress-nginx
        targetRevision: 4.12.1
        path: deploy/dev/platform/base/ingress-nginx
        branch: main
        syncWave: "-1"    
      
      - appName: prometheus
        repoURL: https://prometheus-community.github.io/helm-charts
        chart: kube-prometheus-stack
        targetRevision: 72.5.1
        path: deploy/dev/platform/base/prometheus
        serverSideApply: "true"
        branch: main
        syncWave: "0"   

      - appName: loki
        repoURL: https://grafana.github.io/helm-charts
        targetRevision: 6.29.0
        path: deploy/dev/platform/base/loki
        branch: main
        syncWave: "0"   

      - appName: promtail
        repoURL: https://grafana.github.io/helm-charts
        targetRevision: 6.16.6
        path: deploy/dev/platform/base/promtail
        branch: main
        syncWave: "0"   
      
      - appName: grafana
        repoURL: https://grafana.github.io/helm-charts
        targetRevision: 8.13.1
        path: deploy/dev/platform/base/grafana
        serverSideApply: "true"
        branch: main
        syncWave: "0"
